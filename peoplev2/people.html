<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>People</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Oswald:wght@200..700&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./styles.css">
</head>

<body>
    <div class="sec1" id="prev-section"></div>

    <div class="people-wrapper">
        <section class="peoplesection" id="people-section">
            <div class="peopdiv">
                <div class="peopletag">
                    <h1>People</h1>
                </div>
                <div class="pcnt">
                    <div class="people-cont">
                        <h2>HOME IS WHERE THESE MISFITS ARE</h2>

                    </div>
                    <div class="peoplecard" id="peoplecard">

                    </div>
                </div>


            </div>
            <div class="scroll-b" id="scroll-id">
                <div class="people-horz left-people-horz"></div>
                <div class="scroll-indicator" id="scroll-indicator">
                    [<span>scroll</span>]
                </div>
                <div class="people-horz right-people-horz"></div>
            </div>
        </section>
    </div>
    <div class="sec1" id="next-section"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/ScrollToPlugin.min.js"></script>
    <script>
        // Get the peoplecard container

        const peopleData = [
            { "src": "./assests/images/image 85.png", "name": "Leanordo", "role": "Senior Executive" },
            { "src": "./assests/images/image 86.png", "name": "Jolene Mok", "role": "Senior Producer" },
            { "src": "./assests/images/image 87.png", "name": "Alice Johnson", "role": "Project Manager" },
            { "src": "./assests/images/image 88.png", "name": "Bob Smith", "role": "Software Engineer" },
            { "src": "./assests/images/image 89.png", "name": "Charlie Brown", "role": "Marketing Lead" },
            { "src": "./assests/images/image 90.png", "name": "David Lee", "role": "Graphic Designer" },
            { "src": "./assests/images/image 91.png", "name": "Eva Martinez", "role": "Content Strategist" },
            { "src": "./assests/images/image 92.png", "name": "Frank Williams", "role": "UX Designer" },
            { "src": "./assests/images/image 93.png", "name": "Grace Clark", "role": "Business Analyst" },
            { "src": "./assests/images/image 94.png", "name": "Henry Harris", "role": "Sales Director" },
            { "src": "./assests/images/image 95.png", "name": "Isabella Davis", "role": "Accountant" },
            { "src": "./assests/images/image 96.png", "name": "Jack Thompson", "role": "HR Manager" },
            { "src": "./assests/images/image 97.png", "name": "Kimberly Evans", "role": "Customer Support Lead" },
            { "src": "./assests/images/image 98.png", "name": "Liam Wilson", "role": "Data Scientist" },
            { "src": "./assests/images/image 99.png", "name": "Megan Taylor", "role": "Product Owner" },
            { "src": "./assests/images/image 100.png", "name": "Nathaniel Moore", "role": "DevOps Engineer" },
            { "src": "./assests/images/image 101.png", "name": "Olivia Jackson", "role": "SEO Specialist" },
            { "src": "./assests/images/image 102.png", "name": "Patrick Scott", "role": "Finance Director" },
            { "src": "./assests/images/image 103.png", "name": "Quincy Lee", "role": "Social Media Manager" },
            { "src": "./assests/images/image 104.png", "name": "Rita King", "role": "Operations Manager" },
            { "src": "./assests/images/image 105.png", "name": "Samuel Perez", "role": "Software Developer" },
            { "src": "./assests/images/image 106.png", "name": "Tina Gonzalez", "role": "Marketing Specialist" },
            { "src": "./assests/images/image 107.png", "name": "Ursula Harris", "role": "Project Lead" },
            { "src": "./assests/images/image 108.png", "name": "Victor White", "role": "Senior Developer" },
            { "src": "./assests/images/image 109.png", "name": "Wendy Adams", "role": "UI Designer" },
            { "src": "./assests/images/image 110.png", "name": "Xander Young", "role": "Cybersecurity Expert" },
            { "src": "./assests/images/image 111.png", "name": "Yvonne Carter", "role": "Chief Marketing Officer" },
            { "src": "./assests/images/image 112.png", "name": "Zane Mitchell", "role": "Software Engineer" },
            { "src": "./assests/images/image 113.png", "name": "Amelia Moore", "role": "Product Manager" },
            { "src": "./assests/images/image 114.png", "name": "Ben Foster", "role": "Data Analyst" },
            { "src": "./assests/images/image 115.png", "name": "Catherine Brooks", "role": "QA Engineer" },
            { "src": "./assests/images/image 116.png", "name": "Daniela Collins", "role": "Brand Strategist" }
        ];




        // Get the peoplecard container
        const peoplecard = document.querySelector('.peoplecard');
        var actionBtn = "<div class='viewMoreBtn'><div><a href='#'>View MORE</a></div></div>"

        // Loop through the peopleData array and create the elements
        peopleData.forEach((person,index,__self) => {
            // Create the container div for the card
            const pcard = document.createElement('div');
            const peopleInfo = document.createElement('div');
            peopleInfo.classList.add('peopleInfo');
            pcard.classList.add('pcard');

            // Create the image overlay div
            const imageOverlay = document.createElement('div');
            imageOverlay.classList.add('image-overlay');

            // Create the layer div inside the overlay
            const layer = document.createElement('div');
            layer.classList.add('layer');

            // Create the img element and set the src and alt attributes
            const img = document.createElement('img');
            img.setAttribute('src', person.src);
            img.setAttribute('alt', person.name);  // Using the name as alt text

            // Append the layer and img to the imageOverlay
            imageOverlay.appendChild(layer);
            imageOverlay.appendChild(img);

            // Create the h1 element for the name
            const h1 = document.createElement('h6');
            h1.textContent = person.name;

            // Create the h2 element for the role
            const h2 = document.createElement('p');
            h2.textContent = person.role;

            // Append the imageOverlay, h1, and h2 to the pcard
            pcard.appendChild(imageOverlay);

            peopleInfo.appendChild(h1)
            peopleInfo.appendChild(h2)

            // pcard.appendChild(h1);
            // pcard.appendChild(h2);
            pcard.appendChild(peopleInfo);

            // Append the pcard to the peoplecard container
            peoplecard.appendChild(pcard);


if (index == __self.length - 1) {
    console.log("__self.length", index, __self.length - 1)
    // 		 peoplecard.appendChild(actionBtn);
    peoplecard.innerHTML += actionBtn
}

        });

        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        // Wrap the peoplecard container
        const peopleWrapper = document.querySelector('.people-wrapper');
        const peopleCardWrapper = document.querySelector('.peoplecard');
        const lineLeft = document.querySelector('.left-people-horz');
        const lineRight = document.querySelector('.right-people-horz');
        const scrollText = document.querySelector('.scroll-indicator');
        const scrollContainer = document.querySelector('.scroll-b');

        const totalWidth = peopleCardWrapper.scrollWidth + 169;
        let isDragging = false;
        let animationFrameId;

        // Set up GSAP scroll animation
        gsap.to(peopleCardWrapper, {
            x: () => -(totalWidth - window.innerWidth), // Moves the container leftward
            ease: "none",
            scrollTrigger: {
                trigger: ".peoplesection", // Section to trigger the animation
                start: "top top",
                end: () => `+=${totalWidth}`, // Scroll distance based on total content width
                scrub: true,
                pin: true, // Pins the section during the animation
            },
        });

        function moveScrollText(percentage) {
            const rightValue = 100 - percentage;

            lineLeft.style.width = `${percentage}%`;
            lineRight.style.width = `${rightValue}%`;
        }

        const observer = new MutationObserver(() => {
            const startScroll = peopleWrapper.offsetTop;
            const endScroll = peopleWrapper.scrollHeight;
            if (window.scrollY < startScroll) return 0;
            if (window.scrollY > endScroll) return 100;

            const percentage =
                ((window.scrollY - startScroll) / (endScroll - startScroll)) * 100;

            moveScrollText(percentage)
        });

        observer.observe(peopleCardWrapper, {
            attributes: true,
            attributeFilter: ["style"],
        });


        // Start dragging
        scrollText.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX;
            startLeftWidth = lineLeft.clientWidth;
            scrollText.style.cursor = 'grabbing';
        });

        // Update the line widths using requestAnimationFrame
        const updateLines = (e) => {
            const total = peopleWrapper.scrollHeight;
            const minScroll = peopleWrapper.offsetTop;

            const containerWidth = scrollContainer.clientWidth;
            const percentage = (e.clientX / containerWidth) * 100;

            const result = (percentage / 100) * total;

            if (result > total) {
                window.scrollTo({
                    top: total
                });
            } else if (result < minScroll) {
                window.scrollTo({
                    top: minScroll
                });
            } else {
                window.scrollTo({
                    top: result
                });
            }
            lineLeft.style.width = `${percentage}%`;
            lineRight.style.width = `${100 - percentage}%`;
        };

        // Dragging
        const handleMouseMove = (e) => {
            if (isDragging) {
                // Cancel any previous frame to prevent multiple updates in the same frame
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }

                // Request animation frame for smoother update
                animationFrameId = requestAnimationFrame(() => updateLines(e));
            }
        };

        // Attach the mousemove event
        document.addEventListener('mousemove', handleMouseMove);

        // Stop dragging
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                scrollText.style.cursor = 'grab';
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }
            }
        });

    </script>

</body>

</html>